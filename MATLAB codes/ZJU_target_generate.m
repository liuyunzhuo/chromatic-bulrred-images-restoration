%%%This is a MATLAB script for creating six colors ZJU logo targets,
%we use six narrow band LEDs'spectrum to simulate the target's reflectance spectrum 

clear all;
close all;
clc;
%% partI Input six narrow band LEDs'spectrum
lambda=350:900;
%6种颜色的反射光谱
redsignal=[
    0.0006
    0.0002
    0.0006
    0.0011
    0.0002
    0.0001
    0.0008
    0.0004
         0
    0.0001
    0.0001
    0.0003
    0.0010
    0.0011
    0.0003
    0.0003
    0.0003
    0.0008
    0.0010
    0.0004
    0.0005
    0.0002
    0.0004
    0.0002
    0.0010
    0.0005
         0
    0.0002
    0.0002
    0.0007
    0.0009
    0.0002
    0.0006
    0.0003
    0.0001
    0.0003
    0.0005
    0.0006
    0.0006
    0.0005
    0.0004
    0.0001
    0.0001
    0.0004
    0.0001
    0.0003
    0.0012
    0.0014
    0.0005
    0.0007
    0.0008
    0.0004
    0.0007
    0.0014
    0.0015
    0.0011
    0.0004
    0.0006
    0.0008
    0.0005
    0.0002
    0.0001
    0.0008
    0.0013
    0.0012
    0.0003
         0
    0.0015
    0.0019
    0.0009
    0.0001
    0.0003
    0.0007
    0.0006
    0.0002
    0.0010
    0.0014
    0.0009
    0.0007
    0.0008
    0.0010
    0.0011
    0.0010
    0.0006
    0.0002
    0.0003
    0.0002
    0.0010
    0.0009
    0.0011
    0.0014
    0.0005
    0.0003
    0.0001
    0.0003
    0.0004
    0.0003
    0.0005
    0.0010
    0.0004
    0.0002
    0.0001
    0.0006
    0.0014
    0.0013
    0.0007
    0.0001
    0.0003
    0.0010
    0.0005
    0.0002
    0.0005
    0.0001
    0.0005
    0.0002
    0.0003
    0.0002
    0.0005
    0.0005
         0
         0
    0.0003
    0.0005
    0.0008
    0.0009
    0.0002
    0.0001
    0.0003
    0.0003
    0.0001
    0.0003
    0.0008
    0.0011
    0.0008
    0.0002
    0.0002
    0.0004
    0.0004
    0.0001
    0.0006
    0.0010
    0.0008
    0.0004
    0.0009
    0.0008
    0.0001
    0.0001
    0.0003
    0.0003
    0.0002
    0.0002
    0.0002
    0.0003
         0
    0.0007
    0.0013
    0.0008
    0.0007
    0.0012
    0.0009
    0.0004
    0.0002
    0.0002
    0.0005
    0.0009
    0.0011
    0.0010
    0.0004
         0
    0.0009
    0.0012
    0.0004
    0.0001
    0.0002
    0.0002
    0.0005
    0.0003
         0
    0.0003
    0.0012
    0.0015
    0.0014
    0.0018
    0.0016
    0.0009
    0.0002
    0.0003
    0.0013
    0.0016
    0.0011
    0.0004
    0.0002
    0.0004
    0.0006
    0.0007
    0.0005
    0.0006
    0.0011
    0.0009
    0.0007
    0.0009
    0.0010
    0.0009
    0.0011
    0.0015
    0.0020
    0.0016
    0.0009
    0.0011
    0.0016
    0.0019
    0.0016
    0.0014
    0.0016
    0.0017
    0.0017
    0.0011
    0.0015
    0.0030
    0.0031
    0.0026
    0.0031
    0.0034
    0.0037
    0.0045
    0.0054
    0.0061
    0.0064
    0.0067
    0.0074
    0.0083
    0.0094
    0.0106
    0.0118
    0.0126
    0.0135
    0.0146
    0.0161
    0.0179
    0.0201
    0.0230
    0.0261
    0.0286
    0.0317
    0.0356
    0.0392
    0.0431
    0.0480
    0.0531
    0.0584
    0.0645
    0.0715
    0.0793
    0.0867
    0.0939
    0.1016
    0.1091
    0.1166
    0.1257
    0.1355
    0.1453
    0.1596
    0.1780
    0.1967
    0.2180
    0.2433
    0.2735
    0.3075
    0.3440
    0.3849
    0.4306
    0.4803
    0.5349
    0.5954
    0.6628
    0.7351
    0.8095
    0.8812
    0.9436
    0.9859
    1.0000
    0.9784
    0.9220
    0.8362
    0.7314
    0.6222
    0.5208
    0.4319
    0.3569
    0.2955
    0.2454
    0.2044
    0.1697
    0.1407
    0.1167
    0.0974
    0.0818
    0.0674
    0.0560
    0.0480
    0.0414
    0.0356
    0.0300
    0.0260
    0.0234
    0.0200
    0.0172
    0.0158
    0.0142
    0.0122
    0.0106
    0.0096
    0.0090
    0.0075
    0.0060
    0.0061
    0.0059
    0.0052
    0.0044
    0.0040
    0.0040
    0.0039
    0.0036
    0.0032
    0.0031
    0.0031
    0.0029
    0.0025
    0.0021
    0.0020
    0.0021
    0.0017
    0.0015
    0.0018
    0.0019
    0.0018
    0.0016
    0.0015
    0.0016
    0.0019
    0.0019
    0.0014
    0.0017
    0.0024
    0.0022
    0.0016
    0.0011
    0.0014
    0.0019
    0.0018
    0.0017
    0.0018
    0.0020
    0.0018
    0.0011
    0.0005
    0.0004
    0.0009
    0.0014
    0.0017
    0.0022
    0.0023
    0.0015
    0.0008
    0.0007
    0.0014
    0.0018
    0.0014
    0.0009
    0.0007
    0.0012
    0.0008
    0.0002
    0.0001
    0.0006
    0.0006
    0.0004
    0.0004
    0.0015
    0.0017
    0.0010
    0.0009
    0.0009
    0.0008
    0.0007
    0.0007
    0.0008
    0.0011
    0.0015
    0.0013
    0.0010
    0.0008
    0.0008
    0.0009
    0.0007
    0.0008
    0.0010
    0.0006
    0.0002
    0.0008
    0.0011
    0.0010
    0.0012
    0.0012
    0.0009
    0.0008
    0.0009
    0.0006
    0.0010
    0.0018
    0.0011
    0.0003
    0.0004
    0.0005
    0.0006
    0.0006
    0.0007
    0.0009
    0.0007
    0.0004
    0.0004
    0.0007
    0.0010
    0.0002
    0.0003
    0.0016
    0.0009
    0.0002
    0.0002
    0.0001
    0.0003
    0.0008
    0.0012
    0.0002
    0.0010
    0.0016
    0.0013
    0.0011
    0.0010
    0.0001
    0.0002
    0.0004
    0.0005
    0.0005
    0.0012
    0.0013
    0.0007
    0.0006
    0.0005
         0
         0
    0.0003
    0.0009
    0.0005
    0.0004
    0.0004
    0.0011
    0.0007
    0.0002
    0.0001
    0.0006
    0.0008
    0.0007
    0.0007
    0.0005
    0.0001
    0.0001
    0.0005
    0.0003
    0.0003
    0.0004
    0.0005
    0.0006
    0.0008
    0.0006
    0.0004
    0.0007
    0.0004
    0.0003
    0.0002
    0.0006
    0.0004
    0.0002
    0.0004
    0.0014
    0.0013
    0.0005
    0.0008
    0.0012
    0.0008
    0.0002
    0.0002
    0.0001
    0.0004
    0.0005
    0.0005
    0.0002
    0.0004
    0.0002
    0.0009
    0.0004
    0.0007
    0.0017
    0.0010
    0.0004
    0.0004
    0.0006
    0.0005
    0.0001
    0.0002
    0.0007
    0.0006
    0.0006
    0.0007
    0.0003
    0.0001
    0.0006
    0.0007
    0.0006
    0.0009
    0.0007
         0
    0.0001
    0.0002
    0.0001
    0.0003
    0.0001
    0.0006
    0.0006
         0
    0.0001
    0.0002
    0.0006
    0.0004
    0.0002
    0.0010
    0.0013
    0.0011
    0.0014
    0.0010
    0.0004
    0.0003
    0.0009
    0.0001
    0.0005
    0.0015
    0.0012
    0.0008
    0.0007
    0.0008
    0.0005];

orangesignal=[
        0.0009
    0.0006
    0.0013
    0.0019
    0.0006
    0.0007
    0.0024
    0.0019
    0.0006
    0.0004
    0.0002
    0.0005
    0.0006
    0.0003
    0.0003
    0.0002
    0.0007
    0.0023
    0.0025
    0.0015
    0.0012
    0.0010
    0.0008
    0.0010
    0.0012
    0.0007
    0.0004
    0.0004
    0.0009
    0.0011
    0.0004
    0.0006
    0.0012
    0.0017
    0.0015
    0.0007
    0.0015
    0.0022
    0.0017
    0.0010
    0.0006
    0.0008
    0.0012
    0.0014
    0.0007
    0.0002
    0.0009
    0.0010
    0.0004
    0.0009
    0.0010
    0.0005
    0.0014
    0.0030
    0.0034
    0.0018
    0.0011
    0.0001
    0.0012
    0.0001
    0.0004
    0.0004
    0.0009
    0.0007
         0
    0.0002
    0.0011
    0.0017
    0.0015
    0.0007
         0
    0.0001
    0.0013
    0.0013
    0.0007
    0.0012
    0.0018
    0.0023
    0.0020
    0.0015
    0.0017
    0.0021
    0.0022
    0.0012
    0.0004
    0.0004
    0.0012
    0.0020
    0.0018
    0.0018
    0.0019
    0.0007
    0.0004
    0.0005
    0.0002
    0.0012
    0.0009
    0.0013
    0.0023
    0.0006
    0.0012
    0.0003
    0.0013
    0.0026
    0.0015
    0.0009
    0.0022
    0.0021
    0.0010
    0.0007
    0.0009
    0.0012
    0.0008
    0.0003
    0.0002
    0.0003
    0.0004
    0.0003
    0.0005
    0.0013
    0.0008
         0
    0.0001
    0.0005
    0.0009
    0.0003
    0.0001
    0.0013
    0.0012
    0.0004
    0.0012
    0.0017
    0.0015
    0.0011
    0.0008
    0.0012
    0.0009
    0.0002
    0.0008
    0.0013
    0.0009
         0
    0.0006
    0.0005
    0.0011
    0.0003
    0.0006
    0.0011
    0.0007
    0.0003
    0.0013
    0.0007
    0.0002
    0.0007
    0.0019
    0.0029
    0.0018
    0.0008
    0.0007
    0.0008
    0.0005
    0.0003
    0.0002
    0.0019
    0.0027
    0.0026
    0.0019
    0.0019
    0.0022
    0.0021
    0.0017
    0.0013
    0.0007
    0.0006
    0.0012
    0.0009
    0.0001
    0.0013
    0.0024
    0.0025
    0.0026
    0.0028
    0.0028
    0.0021
    0.0010
    0.0018
    0.0029
    0.0030
    0.0028
    0.0023
    0.0019
    0.0020
    0.0026
    0.0025
    0.0022
    0.0027
    0.0030
    0.0032
    0.0038
    0.0044
    0.0043
    0.0044
    0.0048
    0.0060
    0.0075
    0.0089
    0.0098
    0.0107
    0.0124
    0.0130
    0.0129
    0.0145
    0.0168
    0.0193
    0.0213
    0.0229
    0.0252
    0.0288
    0.0334
    0.0367
    0.0406
    0.0477
    0.0555
    0.0640
    0.0753
    0.0864
    0.0957
    0.1060
    0.1181
    0.1318
    0.1457
    0.1595
    0.1749
    0.1919
    0.2102
    0.2298
    0.2503
    0.2706
    0.2931
    0.3193
    0.3474
    0.3776
    0.4104
    0.4464
    0.4861
    0.5293
    0.5769
    0.6295
    0.6856
    0.7439
    0.8031
    0.8616
    0.9167
    0.9611
    0.9903
    1.0000
    0.9887
    0.9565
    0.9057
    0.8419
    0.7709
    0.6953
    0.6187
    0.5448
    0.4747
    0.4099
    0.3518
    0.3004
    0.2555
    0.2168
    0.1838
    0.1552
    0.1308
    0.1104
    0.0941
    0.0808
    0.0682
    0.0576
    0.0492
    0.0429
    0.0377
    0.0326
    0.0282
    0.0246
    0.0211
    0.0180
    0.0157
    0.0138
    0.0123
    0.0115
    0.0102
    0.0085
    0.0080
    0.0075
    0.0057
    0.0053
    0.0058
    0.0049
    0.0037
    0.0028
    0.0030
    0.0035
    0.0025
    0.0025
    0.0036
    0.0032
    0.0026
    0.0032
    0.0032
    0.0027
    0.0032
    0.0032
    0.0024
    0.0018
    0.0016
    0.0020
    0.0023
    0.0024
    0.0025
    0.0024
    0.0020
    0.0020
    0.0024
    0.0031
    0.0031
    0.0023
    0.0024
    0.0027
    0.0025
    0.0026
    0.0027
    0.0020
    0.0017
    0.0024
    0.0025
    0.0021
    0.0015
    0.0012
    0.0013
    0.0013
    0.0017
    0.0023
    0.0024
    0.0022
    0.0030
    0.0027
    0.0010
    0.0013
    0.0022
    0.0019
    0.0021
    0.0028
    0.0029
    0.0026
    0.0020
    0.0009
    0.0001
    0.0013
    0.0023
    0.0023
    0.0016
    0.0010
    0.0013
    0.0014
    0.0012
    0.0014
    0.0017
    0.0019
    0.0017
    0.0009
    0.0002
    0.0004
    0.0004
    0.0011
    0.0019
    0.0025
    0.0012
    0.0001
    0.0013
    0.0018
    0.0010
    0.0012
    0.0017
    0.0019
    0.0016
    0.0013
    0.0019
    0.0021
    0.0017
    0.0020
    0.0023
    0.0020
    0.0017
    0.0014
    0.0012
    0.0009
    0.0005
    0.0001
         0
    0.0005
    0.0012
    0.0020
    0.0022
    0.0015
         0
    0.0007
    0.0020
    0.0012
    0.0009
    0.0015
    0.0013
    0.0006
    0.0002
    0.0005
    0.0001
    0.0012
    0.0019
    0.0017
    0.0011
    0.0007
    0.0008
    0.0007
    0.0002
    0.0003
    0.0004
    0.0021
    0.0016
    0.0003
    0.0004
    0.0012
    0.0019
    0.0019
    0.0010
    0.0006
    0.0016
    0.0016
    0.0006
    0.0005
    0.0010
    0.0006
    0.0003
    0.0003
         0
         0
    0.0014
    0.0014
    0.0003
    0.0013
    0.0017
    0.0006
    0.0010
    0.0018
    0.0012
    0.0003
    0.0003
    0.0005
    0.0015
    0.0020
    0.0014
    0.0006
    0.0009
    0.0010
    0.0008
    0.0006
    0.0001
    0.0005
    0.0001
    0.0008
    0.0001
    0.0001
    0.0014
    0.0007
    0.0001
    0.0006
    0.0014
    0.0019
    0.0015
    0.0015
    0.0018
    0.0013
    0.0013
    0.0022
    0.0016
    0.0008
    0.0021
    0.0015
    0.0003
    0.0011
    0.0020
    0.0006
    0.0010
    0.0013
    0.0010
    0.0020
    0.0012
    0.0011
    0.0009
    0.0004
    0.0004
    0.0004
    0.0004
    0.0004
    0.0019
    0.0011
    0.0001
    0.0001
    0.0003
    0.0002
    0.0009
    0.0015
    0.0013
    0.0006
    0.0004
    0.0009
    0.0004
    0.0001
    0.0003
    0.0004
    0.0006
    0.0014
    0.0011
    0.0005
    0.0008
    0.0006
    0.0006
    0.0006
    0.0004
    0.0008
    0.0011
    0.0005
    0.0009
    0.0008
    0.0003
         0
    0.0009
    0.0013
    0.0011
    0.0005
    0.0002
    0.0003
    0.0008
    0.0003
    0.0014
    0.0012
    0.0017
    0.0024
    0.0016
    0.0011
    0.0011
    0.0008
    0.0004];
yellowsignal=[
        0.0013
    0.0010
    0.0011
    0.0016
    0.0007
    0.0002
    0.0020
    0.0017
    0.0002
    0.0007
    0.0015
    0.0012
    0.0020
    0.0032
    0.0029
    0.0015
    0.0001
    0.0011
    0.0019
    0.0001
    0.0002
    0.0010
    0.0024
    0.0024
    0.0010
    0.0005
    0.0011
    0.0026
    0.0029
    0.0018
    0.0003
    0.0004
    0.0027
    0.0021
    0.0004
    0.0022
    0.0033
    0.0028
    0.0029
    0.0028
    0.0016
    0.0022
    0.0035
    0.0017
    0.0006
    0.0016
    0.0012
    0.0007
    0.0020
    0.0028
    0.0023
    0.0015
    0.0009
    0.0010
    0.0006
         0
    0.0004
    0.0015
    0.0026
    0.0009
    0.0006
    0.0019
    0.0032
    0.0025
    0.0010
    0.0002
    0.0001
    0.0012
    0.0024
    0.0008
    0.0002
    0.0001
    0.0001
    0.0001
    0.0005
    0.0011
    0.0019
    0.0018
    0.0020
    0.0026
    0.0017
    0.0008
    0.0022
    0.0025
    0.0012
    0.0001
    0.0002
    0.0009
    0.0015
    0.0014
    0.0011
    0.0015
    0.0027
    0.0029
    0.0021
    0.0006
    0.0003
    0.0001
    0.0007
    0.0018
    0.0027
    0.0022
    0.0010
    0.0006
    0.0010
    0.0016
    0.0007
    0.0001
    0.0012
    0.0019
    0.0018
    0.0013
    0.0008
    0.0009
    0.0022
    0.0033
    0.0013
    0.0005
    0.0019
    0.0020
    0.0013
    0.0004
    0.0005
    0.0015
    0.0025
    0.0029
    0.0026
    0.0022
    0.0022
    0.0025
    0.0029
    0.0030
    0.0016
    0.0009
    0.0027
    0.0031
    0.0020
    0.0015
    0.0025
    0.0048
    0.0052
    0.0045
    0.0043
    0.0037
    0.0027
    0.0026
    0.0033
    0.0049
    0.0059
    0.0059
    0.0052
    0.0047
    0.0049
    0.0064
    0.0079
    0.0082
    0.0094
    0.0115
    0.0124
    0.0125
    0.0125
    0.0144
    0.0175
    0.0188
    0.0208
    0.0243
    0.0279
    0.0317
    0.0359
    0.0401
    0.0445
    0.0486
    0.0535
    0.0599
    0.0677
    0.0762
    0.0838
    0.0930
    0.1050
    0.1183
    0.1337
    0.1522
    0.1729
    0.1962
    0.2240
    0.2531
    0.2816
    0.3096
    0.3387
    0.3712
    0.4053
    0.4407
    0.4801
    0.5231
    0.5692
    0.6184
    0.6711
    0.7284
    0.7882
    0.8484
    0.9052
    0.9534
    0.9866
    1.0000
    0.9891
    0.9481
    0.8831
    0.8007
    0.7089
    0.6152
    0.5285
    0.4509
    0.3843
    0.3271
    0.2782
    0.2362
    0.2001
    0.1691
    0.1435
    0.1221
    0.1042
    0.0885
    0.0750
    0.0646
    0.0559
    0.0485
    0.0428
    0.0378
    0.0315
    0.0264
    0.0231
    0.0209
    0.0183
    0.0146
    0.0134
    0.0137
    0.0118
    0.0100
    0.0093
    0.0097
    0.0099
    0.0085
    0.0078
    0.0076
    0.0061
    0.0048
    0.0046
    0.0046
    0.0045
    0.0041
    0.0042
    0.0047
    0.0046
    0.0038
    0.0023
    0.0027
    0.0043
    0.0042
    0.0028
    0.0011
    0.0018
    0.0033
    0.0018
    0.0012
    0.0022
    0.0026
    0.0029
    0.0036
    0.0034
    0.0024
    0.0017
    0.0019
    0.0029
    0.0020
    0.0012
    0.0026
    0.0030
    0.0021
    0.0014
    0.0013
    0.0022
    0.0032
    0.0039
    0.0031
    0.0025
    0.0026
    0.0030
    0.0032
    0.0027
    0.0026
    0.0028
    0.0022
    0.0019
    0.0023
    0.0027
    0.0033
    0.0042
    0.0044
    0.0038
    0.0039
    0.0034
    0.0017
    0.0014
    0.0022
    0.0029
    0.0028
    0.0018
    0.0024
    0.0032
    0.0027
    0.0028
    0.0035
    0.0030
    0.0018
    0.0004
    0.0002
    0.0003
    0.0021
    0.0029
    0.0023
    0.0020
    0.0018
    0.0014
    0.0018
    0.0025
    0.0027
    0.0020
    0.0007
    0.0005
    0.0007
    0.0003
    0.0003
    0.0005
    0.0006
    0.0007
    0.0008
    0.0002
    0.0007
    0.0021
    0.0028
    0.0011
    0.0005
    0.0009
    0.0019
    0.0020
    0.0014
    0.0012
    0.0016
    0.0025
    0.0026
    0.0019
    0.0009
    0.0012
    0.0021
    0.0008
    0.0004
    0.0016
    0.0011
    0.0003
    0.0017
    0.0020
    0.0012
    0.0022
    0.0023
    0.0006
    0.0010
    0.0021
    0.0018
    0.0019
    0.0026
    0.0026
    0.0017
    0.0002
    0.0002
    0.0003
    0.0010
    0.0009
         0
    0.0006
    0.0015
    0.0018
    0.0021
    0.0019
         0
    0.0002
    0.0029
    0.0019
         0
    0.0002
    0.0002
    0.0010
    0.0012
    0.0009
    0.0001
    0.0018
    0.0028
    0.0013
    0.0009
    0.0016
    0.0005
    0.0006
    0.0010
    0.0006
    0.0024
    0.0019
    0.0015
    0.0015
    0.0011
    0.0006
    0.0004
    0.0011
    0.0015
    0.0005
    0.0003
    0.0002
    0.0012
    0.0021
    0.0016
    0.0015
    0.0020
    0.0030
    0.0023
    0.0005
    0.0015
    0.0025
    0.0019
    0.0022
    0.0027
    0.0020
    0.0020
    0.0024
    0.0007
    0.0002
    0.0011
    0.0011
    0.0009
    0.0029
    0.0029
    0.0007
    0.0005
    0.0006
    0.0001
    0.0005
    0.0014
    0.0021
    0.0012
    0.0004
    0.0011
    0.0014
    0.0010
    0.0014
         0
    0.0023
    0.0032
    0.0027
    0.0015
    0.0008
    0.0006
    0.0010
    0.0019
    0.0002
    0.0016
    0.0018
    0.0007
    0.0003
    0.0013
    0.0014
    0.0008
    0.0001
    0.0003
    0.0002
    0.0005
    0.0002
    0.0007
    0.0007
    0.0001
    0.0012
    0.0017
    0.0017
    0.0016
    0.0008
    0.0001
    0.0011
    0.0012
    0.0013
    0.0007
    0.0015
    0.0018
    0.0009
    0.0004
    0.0001
    0.0009
    0.0019
    0.0017
    0.0015
    0.0027
    0.0020
    0.0002
    0.0007
    0.0007
    0.0002
    0.0017
    0.0036
    0.0028
    0.0031
    0.0041
    0.0036
    0.0032
    0.0031
    0.0014
    0.0004
    0.0014
    0.0020
    0.0018
    0.0004
    0.0010
    0.0027
    0.0008
    0.0001
    0.0018
    0.0023
    0.0021
    0.0020
    0.0016
    0.0012
    0.0011
    0.0009
    0.0007
    0.0014
    0.0014
    0.0005
    0.0014
    0.0027
    0.0026
    0.0030
    0.0033
    0.0008
    0.0004
    0.0006
    0.0007
    0.0006
    0.0009
    0.0011
    0.0010
    0.0005
    0.0002
    0.0006
    0.0002
    0.0017
    0.0031
    0.0015];
greensignal=[
    
    0.0007
    0.0025
    0.0028
    0.0019
    0.0013
    0.0020
    0.0035
    0.0029
    0.0017
    0.0006
    0.0002
    0.0003
    0.0005
    0.0007
    0.0007
    0.0001
    0.0003
    0.0026
    0.0027
    0.0011
    0.0012
    0.0009
         0
    0.0014
    0.0029
    0.0013
    0.0001
    0.0003
    0.0004
    0.0015
    0.0024
    0.0017
    0.0004
    0.0008
    0.0007
         0
    0.0013
    0.0027
    0.0028
    0.0021
    0.0011
    0.0009
    0.0013
    0.0021
    0.0013
    0.0003
    0.0009
    0.0015
    0.0016
    0.0018
    0.0013
    0.0002
    0.0015
    0.0039
    0.0045
    0.0033
    0.0012
    0.0018
    0.0023
    0.0005
    0.0003
    0.0003
    0.0017
    0.0025
    0.0023
    0.0023
    0.0025
    0.0031
    0.0034
    0.0031
    0.0011
    0.0004
    0.0020
    0.0011
    0.0005
    0.0013
    0.0024
    0.0019
    0.0025
    0.0031
    0.0028
    0.0030
    0.0033
    0.0012
    0.0003
    0.0002
    0.0009
    0.0020
    0.0022
    0.0024
    0.0027
    0.0024
    0.0017
    0.0010
    0.0011
    0.0016
    0.0019
    0.0017
    0.0010
    0.0007
    0.0009
    0.0019
    0.0036
    0.0051
    0.0027
    0.0009
    0.0020
    0.0035
    0.0044
    0.0037
    0.0029
    0.0026
    0.0039
    0.0046
    0.0028
    0.0031
    0.0052
    0.0064
    0.0066
    0.0061
    0.0062
    0.0071
    0.0080
    0.0091
    0.0103
    0.0112
    0.0121
    0.0137
    0.0160
    0.0187
    0.0209
    0.0239
    0.0277
    0.0302
    0.0328
    0.0376
    0.0434
    0.0495
    0.0547
    0.0612
    0.0704
    0.0795
    0.0894
    0.1018
    0.1147
    0.1278
    0.1435
    0.1617
    0.1824
    0.2061
    0.2326
    0.2597
    0.2912
    0.3291
    0.3679
    0.4084
    0.4534
    0.5016
    0.5521
    0.6031
    0.6550
    0.7077
    0.7606
    0.8123
    0.8602
    0.9022
    0.9366
    0.9639
    0.9838
    0.9956
    1.0000
    0.9968
    0.9851
    0.9652
    0.9378
    0.9077
    0.8753
    0.8377
    0.7992
    0.7618
    0.7256
    0.6898
    0.6535
    0.6183
    0.5850
    0.5547
    0.5263
    0.4987
    0.4715
    0.4447
    0.4191
    0.3951
    0.3723
    0.3483
    0.3242
    0.3023
    0.2817
    0.2619
    0.2416
    0.2224
    0.2053
    0.1901
    0.1762
    0.1628
    0.1507
    0.1401
    0.1313
    0.1230
    0.1139
    0.1047
    0.0959
    0.0892
    0.0835
    0.0778
    0.0726
    0.0676
    0.0614
    0.0567
    0.0540
    0.0494
    0.0449
    0.0428
    0.0396
    0.0355
    0.0332
    0.0308
    0.0275
    0.0256
    0.0248
    0.0241
    0.0218
    0.0184
    0.0192
    0.0203
    0.0178
    0.0158
    0.0146
    0.0126
    0.0106
    0.0090
    0.0088
    0.0093
    0.0092
    0.0093
    0.0095
    0.0078
    0.0066
    0.0080
    0.0084
    0.0076
    0.0062
    0.0053
    0.0056
    0.0055
    0.0053
    0.0059
    0.0061
    0.0057
    0.0048
    0.0036
    0.0025
    0.0031
    0.0046
    0.0039
    0.0033
    0.0036
    0.0040
    0.0039
    0.0021
    0.0011
    0.0016
    0.0027
    0.0025
    0.0002
    0.0006
    0.0036
    0.0030
    0.0019
    0.0014
    0.0022
    0.0033
    0.0035
    0.0038
    0.0040
    0.0020
    0.0006
    0.0013
    0.0019
    0.0022
    0.0025
    0.0022
    0.0012
    0.0014
    0.0018
    0.0012
    0.0010
    0.0012
    0.0015
    0.0009
    0.0009
    0.0004
    0.0011
    0.0011
    0.0014
    0.0022
    0.0021
    0.0022
    0.0033
    0.0031
    0.0017
    0.0004
    0.0004
    0.0020
    0.0024
    0.0019
    0.0013
    0.0011
    0.0015
    0.0014
    0.0011
    0.0009
    0.0019
    0.0031
    0.0019
    0.0012
    0.0018
    0.0021
    0.0019
    0.0016
    0.0012
    0.0008
    0.0004
    0.0009
    0.0022
    0.0017
    0.0004
    0.0004
    0.0008
    0.0012
    0.0012
    0.0011
    0.0012
    0.0009
    0.0008
    0.0029
    0.0032
    0.0008
    0.0005
    0.0012
    0.0013
    0.0015
    0.0018
    0.0020
    0.0020
    0.0016
    0.0001
    0.0007
    0.0016
    0.0027
    0.0020
    0.0027
    0.0025
         0
    0.0002
    0.0014
    0.0023
    0.0020
    0.0006
    0.0003
    0.0002
    0.0009
    0.0005
    0.0010
    0.0007
    0.0008
    0.0018
    0.0005
    0.0010
    0.0007
    0.0020
    0.0022
    0.0019
    0.0020
    0.0026
    0.0018
    0.0007
    0.0020
    0.0029
    0.0026
    0.0023
    0.0019
    0.0012
    0.0021
    0.0036
    0.0017
    0.0004
    0.0008
    0.0003
    0.0001
    0.0012
    0.0022
    0.0024
    0.0024
    0.0016
    0.0004
    0.0013
    0.0027
    0.0015
    0.0009
    0.0013
    0.0012
    0.0014
    0.0022
    0.0017
    0.0006
    0.0008
    0.0012
    0.0014
    0.0024
    0.0028
    0.0020
    0.0010
         0
    0.0008
    0.0003
    0.0013
    0.0008
    0.0002
    0.0001
    0.0002
    0.0001
    0.0005
    0.0009
    0.0010
    0.0009
    0.0025
    0.0014
    0.0006
    0.0004
    0.0003
    0.0005
    0.0008
    0.0008
    0.0013
    0.0029
    0.0031
    0.0017
    0.0003
    0.0002
    0.0005
    0.0008
    0.0007
    0.0006
    0.0002
    0.0001
    0.0018
    0.0024
    0.0006
    0.0004
    0.0014
    0.0026
    0.0018
    0.0005
    0.0002
    0.0012
    0.0014
    0.0018
    0.0018
    0.0004
    0.0001
    0.0004
    0.0003
    0.0005
    0.0007
    0.0018
    0.0022
    0.0013
    0.0007
    0.0007
    0.0011
    0.0011
    0.0005
    0.0007
    0.0015
    0.0024
    0.0025
    0.0017
    0.0014
    0.0010
    0.0003
    0.0006
    0.0006
    0.0019
    0.0027
    0.0016
    0.0013
    0.0014
    0.0012
    0.0001
    0.0014
    0.0009
    0.0010
    0.0031
    0.0020
    0.0008
    0.0006
    0.0004
    0.0009
    0.0002
    0.0009
    0.0008
    0.0007
    0.0003
    0.0001
    0.0007
    0.0018
    0.0023
    0.0027
    0.0025
    0.0009
    0.0004
    0.0007
    0.0007
    0.0010
    0.0010
    0.0009
    0.0005
    0.0014
    0.0006
    0.0009
    0.0014
    0.0028
    0.0014
    0.0007
    0.0011
    0.0024
    0.0020
    0.0005
    0.0013
    0.0011
    0.0004
    0.0005
    0.0021
    0.0025
    0.0025
    0.0022
    0.0021
    0.0019
    0.0018
    0.0015
    0.0006];
cyansignal=[
    
    0.0019
    0.0014
    0.0013
    0.0012
    0.0002
    0.0006
    0.0023
    0.0017
    0.0005
    0.0001
    0.0002
    0.0003
    0.0002
    0.0003
    0.0006
    0.0003
    0.0006
    0.0025
    0.0031
    0.0023
    0.0004
    0.0006
    0.0001
    0.0015
    0.0022
    0.0009
    0.0005
    0.0011
    0.0012
    0.0010
    0.0006
         0
    0.0003
    0.0008
    0.0009
         0
    0.0019
    0.0036
    0.0027
    0.0011
    0.0003
    0.0001
    0.0007
    0.0015
    0.0009
    0.0002
    0.0011
    0.0016
    0.0016
    0.0022
    0.0026
    0.0024
    0.0029
    0.0037
    0.0039
    0.0030
    0.0016
    0.0014
    0.0013
    0.0004
    0.0004
    0.0013
    0.0022
    0.0022
    0.0012
    0.0016
    0.0027
    0.0036
    0.0032
    0.0021
    0.0021
    0.0020
    0.0015
    0.0018
    0.0028
    0.0037
    0.0037
    0.0030
    0.0036
    0.0042
    0.0037
    0.0040
    0.0045
    0.0026
    0.0016
    0.0027
    0.0027
    0.0022
    0.0026
    0.0038
    0.0050
    0.0044
    0.0037
    0.0040
    0.0043
    0.0045
    0.0044
    0.0048
    0.0057
    0.0059
    0.0062
    0.0074
    0.0088
    0.0097
    0.0088
    0.0089
    0.0114
    0.0132
    0.0143
    0.0154
    0.0168
    0.0190
    0.0221
    0.0255
    0.0284
    0.0320
    0.0367
    0.0421
    0.0482
    0.0548
    0.0620
    0.0704
    0.0806
    0.0927
    0.1065
    0.1209
    0.1380
    0.1594
    0.1837
    0.2111
    0.2424
    0.2776
    0.3167
    0.3599
    0.4070
    0.4578
    0.5129
    0.5711
    0.6296
    0.6894
    0.7501
    0.8068
    0.8586
    0.9063
    0.9453
    0.9735
    0.9919
    1.0000
    0.9977
    0.9852
    0.9634
    0.9340
    0.8982
    0.8578
    0.8158
    0.7730
    0.7294
    0.6870
    0.6472
    0.6118
    0.5786
    0.5458
    0.5163
    0.4900
    0.4650
    0.4414
    0.4187
    0.3936
    0.3682
    0.3468
    0.3257
    0.3043
    0.2836
    0.2638
    0.2455
    0.2285
    0.2127
    0.1965
    0.1823
    0.1709
    0.1595
    0.1483
    0.1386
    0.1291
    0.1198
    0.1113
    0.1040
    0.0981
    0.0917
    0.0848
    0.0780
    0.0719
    0.0667
    0.0621
    0.0577
    0.0532
    0.0505
    0.0489
    0.0439
    0.0388
    0.0361
    0.0332
    0.0303
    0.0286
    0.0277
    0.0272
    0.0257
    0.0240
    0.0228
    0.0211
    0.0191
    0.0178
    0.0167
    0.0158
    0.0154
    0.0151
    0.0136
    0.0129
    0.0133
    0.0112
    0.0086
    0.0084
    0.0082
    0.0077
    0.0080
    0.0085
    0.0086
    0.0067
    0.0043
    0.0052
    0.0059
    0.0055
    0.0062
    0.0064
    0.0048
    0.0041
    0.0045
    0.0038
    0.0026
    0.0017
    0.0029
    0.0047
    0.0041
    0.0036
    0.0036
    0.0034
    0.0032
    0.0033
    0.0031
    0.0029
    0.0030
    0.0033
    0.0038
    0.0040
    0.0040
    0.0035
    0.0031
    0.0029
    0.0025
    0.0019
    0.0013
    0.0017
    0.0028
    0.0023
    0.0019
    0.0021
    0.0022
    0.0022
    0.0018
    0.0017
    0.0019
    0.0021
    0.0017
    0.0005
    0.0009
    0.0024
    0.0026
    0.0022
    0.0015
    0.0021
    0.0030
    0.0030
    0.0025
    0.0018
    0.0009
    0.0011
    0.0027
    0.0031
    0.0023
    0.0019
    0.0020
    0.0026
    0.0022
    0.0016
    0.0016
    0.0017
    0.0017
    0.0012
    0.0004
    0.0003
    0.0002
    0.0010
    0.0007
    0.0006
    0.0009
    0.0016
    0.0025
    0.0033
    0.0031
    0.0021
    0.0014
    0.0015
    0.0024
    0.0021
    0.0014
    0.0018
    0.0021
    0.0020
    0.0019
    0.0014
    0.0003
    0.0013
    0.0029
    0.0022
    0.0017
    0.0024
    0.0028
    0.0027
    0.0021
    0.0010
         0
    0.0013
    0.0024
    0.0023
    0.0022
    0.0019
    0.0010
    0.0008
    0.0013
    0.0015
    0.0015
    0.0015
    0.0012
    0.0012
    0.0029
    0.0030
    0.0010
    0.0012
    0.0020
    0.0015
    0.0014
    0.0018
    0.0019
    0.0016
    0.0007
    0.0003
    0.0003
    0.0022
    0.0034
    0.0027
    0.0017
    0.0010
    0.0012
    0.0019
    0.0027
    0.0021
    0.0013
    0.0008
    0.0005
    0.0005
    0.0008
    0.0009
    0.0008
    0.0005
    0.0010
    0.0021
    0.0004
    0.0027
    0.0013
    0.0024
    0.0001
    0.0006
    0.0016
    0.0010
    0.0010
    0.0015
    0.0020
    0.0024
    0.0023
    0.0009
    0.0001
    0.0015
    0.0029
    0.0033
    0.0017
    0.0005
    0.0004
    0.0001
         0
    0.0008
    0.0016
    0.0022
    0.0028
    0.0020
    0.0002
    0.0002
    0.0018
    0.0012
    0.0009
    0.0012
    0.0003
    0.0002
    0.0008
    0.0004
    0.0004
    0.0008
    0.0014
    0.0011
    0.0011
    0.0011
    0.0005
         0
    0.0001
    0.0005
    0.0017
    0.0029
    0.0022
    0.0009
    0.0005
    0.0009
    0.0014
    0.0004
    0.0005
    0.0003
    0.0015
    0.0030
    0.0023
    0.0014
    0.0009
    0.0005
    0.0003
    0.0005
    0.0004
    0.0008
    0.0024
    0.0027
    0.0015
    0.0002
    0.0003
    0.0023
    0.0024
    0.0020
    0.0029
    0.0023
    0.0006
    0.0017
    0.0024
    0.0014
    0.0015
    0.0021
    0.0018
    0.0006
    0.0005
    0.0008
    0.0016
    0.0002
    0.0005
    0.0015
    0.0012
    0.0007
    0.0004
    0.0005
    0.0010
    0.0017
    0.0023
    0.0026
    0.0021
    0.0021
    0.0023
    0.0013
    0.0008
    0.0014
    0.0012
    0.0010
    0.0022
    0.0021
    0.0010
    0.0015
    0.0016
    0.0004
    0.0004
         0
    0.0025
    0.0027
    0.0008
    0.0004
    0.0008
    0.0016
    0.0014
    0.0010
    0.0011
    0.0021
    0.0031
    0.0014
    0.0005
    0.0013
    0.0002
    0.0009
    0.0004
    0.0011
    0.0011
    0.0019
    0.0015
    0.0002
    0.0007
    0.0020
    0.0020
    0.0018
    0.0016
    0.0012
    0.0007
    0.0004
    0.0001
    0.0001
    0.0004
    0.0006
         0
    0.0026
    0.0024
    0.0004
    0.0002
    0.0011
    0.0024
    0.0018
    0.0009
    0.0014
    0.0015
    0.0010
    0.0013
    0.0010
    0.0001
    0.0008
    0.0020
    0.0022
    0.0027
    0.0028
    0.0015
    0.0007
    0.0010
    0.0016
    0.0018];
bluesignal=[
    
    0.0001
    0.0004
    0.0011
    0.0012
    0.0001
    0.0001
    0.0017
    0.0016
    0.0012
    0.0013
    0.0004
    0.0009
    0.0009
    0.0001
    0.0009
    0.0007
    0.0009
    0.0029
    0.0025
    0.0005
    0.0011
    0.0013
    0.0002
    0.0002
    0.0003
    0.0004
    0.0002
    0.0002
    0.0003
    0.0007
    0.0012
    0.0004
    0.0007
    0.0004
    0.0007
         0
    0.0011
    0.0023
    0.0027
    0.0030
    0.0029
    0.0017
    0.0010
    0.0011
    0.0003
    0.0002
    0.0013
    0.0022
    0.0021
    0.0024
    0.0025
    0.0021
    0.0026
    0.0033
    0.0037
    0.0030
    0.0014
    0.0018
    0.0022
    0.0014
    0.0024
    0.0044
    0.0046
    0.0036
    0.0022
    0.0030
    0.0045
    0.0048
    0.0046
    0.0044
    0.0044
    0.0050
    0.0061
    0.0062
    0.0061
    0.0081
    0.0100
    0.0111
    0.0118
    0.0124
    0.0133
    0.0146
    0.0162
    0.0180
    0.0205
    0.0237
    0.0265
    0.0300
    0.0358
    0.0416
    0.0470
    0.0534
    0.0607
    0.0695
    0.0800
    0.0921
    0.1046
    0.1196
    0.1373
    0.1556
    0.1777
    0.2068
    0.2379
    0.2703
    0.3052
    0.3459
    0.3941
    0.4474
    0.5048
    0.5661
    0.6288
    0.6921
    0.7585
    0.8224
    0.8784
    0.9262
    0.9639
    0.9895
    1.0000
    0.9938
    0.9731
    0.9405
    0.8989
    0.8474
    0.7892
    0.7328
    0.6784
    0.6260
    0.5773
    0.5336
    0.4969
    0.4638
    0.4325
    0.4019
    0.3733
    0.3479
    0.3230
    0.2977
    0.2728
    0.2488
    0.2264
    0.2050
    0.1852
    0.1683
    0.1529
    0.1387
    0.1266
    0.1159
    0.1061
    0.0975
    0.0900
    0.0825
    0.0763
    0.0720
    0.0673
    0.0621
    0.0561
    0.0508
    0.0466
    0.0436
    0.0405
    0.0359
    0.0328
    0.0314
    0.0306
    0.0295
    0.0274
    0.0251
    0.0234
    0.0234
    0.0221
    0.0193
    0.0187
    0.0182
    0.0162
    0.0151
    0.0147
    0.0138
    0.0131
    0.0129
    0.0125
    0.0120
    0.0120
    0.0115
    0.0106
    0.0099
    0.0094
    0.0088
    0.0084
    0.0079
    0.0064
    0.0058
    0.0067
    0.0065
    0.0057
    0.0053
    0.0056
    0.0062
    0.0053
    0.0043
    0.0040
    0.0041
    0.0043
    0.0036
    0.0043
    0.0065
    0.0060
    0.0048
    0.0059
    0.0059
    0.0046
    0.0039
    0.0034
    0.0032
    0.0038
    0.0043
    0.0019
    0.0018
    0.0047
    0.0044
    0.0027
    0.0020
    0.0015
    0.0013
    0.0017
    0.0022
    0.0023
    0.0020
    0.0017
    0.0020
    0.0023
    0.0022
    0.0012
    0.0007
    0.0019
    0.0022
    0.0013
         0
    0.0007
    0.0006
    0.0005
    0.0003
    0.0005
    0.0012
    0.0014
    0.0016
    0.0019
    0.0025
    0.0026
    0.0023
    0.0017
    0.0017
    0.0026
    0.0022
    0.0016
    0.0026
    0.0025
    0.0010
    0.0002
    0.0002
    0.0009
    0.0010
    0.0006
    0.0015
    0.0011
    0.0007
    0.0007
    0.0027
    0.0008
    0.0003
    0.0018
    0.0023
    0.0014
    0.0006
    0.0006
    0.0010
    0.0021
    0.0019
    0.0007
    0.0016
    0.0031
    0.0029
    0.0027
    0.0024
    0.0013
    0.0007
    0.0013
    0.0014
    0.0012
    0.0022
    0.0019
    0.0002
    0.0011
    0.0021
    0.0006
    0.0003
    0.0011
    0.0009
    0.0002
    0.0008
    0.0002
    0.0008
    0.0005
         0
    0.0004
    0.0001
    0.0007
    0.0020
    0.0021
    0.0015
    0.0020
    0.0021
    0.0014
    0.0014
    0.0012
    0.0007
    0.0011
    0.0001
    0.0005
    0.0008
    0.0013
    0.0023
    0.0030
    0.0024
    0.0019
    0.0021
    0.0024
    0.0023
    0.0014
    0.0004
    0.0004
    0.0009
    0.0001
    0.0021
    0.0023
    0.0013
    0.0004
    0.0002
    0.0007
    0.0010
    0.0011
    0.0012
    0.0009
    0.0007
    0.0018
    0.0019
    0.0004
    0.0001
    0.0004
    0.0006
    0.0011
    0.0016
    0.0007
         0
    0.0001
    0.0010
    0.0018
    0.0006
    0.0019
    0.0014
    0.0022
    0.0025
    0.0007
    0.0004
    0.0005
         0
    0.0001
    0.0012
    0.0007
    0.0003
    0.0001
         0
    0.0002
    0.0004
    0.0010
    0.0019
    0.0002
    0.0016
    0.0007
    0.0020
    0.0015
    0.0009
    0.0006
    0.0008
    0.0005
    0.0002
    0.0012
    0.0008
    0.0010
    0.0004
    0.0017
    0.0003
    0.0010
    0.0029
    0.0013
    0.0002
    0.0008
    0.0003
    0.0003
    0.0023
    0.0021
    0.0003
    0.0017
    0.0018
    0.0008
    0.0002
    0.0016
    0.0004
    0.0001
    0.0011
    0.0006
    0.0004
    0.0010
    0.0003
    0.0006
    0.0008
    0.0006
    0.0018
    0.0027
    0.0018
    0.0006
    0.0002
    0.0026
    0.0010
    0.0002
    0.0003
    0.0002
    0.0010
    0.0015
    0.0014
    0.0011
    0.0014
    0.0011
    0.0004
    0.0018
    0.0022
    0.0008
    0.0006
    0.0014
    0.0007
    0.0003
    0.0008
    0.0004
    0.0007
    0.0023
    0.0020
    0.0003
    0.0001
    0.0001
    0.0002
    0.0008
    0.0019
    0.0016
    0.0004
    0.0008
    0.0015
    0.0028
    0.0009
    0.0004
    0.0005
    0.0008
    0.0013
    0.0008
    0.0009
    0.0008
    0.0003
    0.0009
    0.0016
    0.0006
    0.0004
    0.0011
    0.0011
    0.0009
    0.0011
    0.0018
    0.0024
    0.0022
    0.0010
    0.0004
    0.0008
    0.0014
    0.0001
    0.0002
    0.0014
    0.0026
    0.0015
    0.0008
    0.0010
    0.0025
    0.0016
    0.0001
    0.0001
    0.0025
    0.0025
    0.0001
         0
    0.0005
    0.0007
    0.0002
    0.0008
    0.0016
    0.0005
    0.0016
    0.0015
    0.0008
    0.0003
    0.0002
    0.0001
    0.0012
    0.0013
    0.0006
    0.0013
    0.0011
    0.0002
    0.0001
    0.0010
    0.0023
    0.0032
    0.0030
    0.0010
    0.0005
    0.0009
    0.0006
    0.0010
    0.0027
    0.0021
    0.0002
    0.0025
    0.0019
    0.0006
    0.0004
    0.0016
    0.0016
    0.0014
    0.0013
    0.0017
    0.0012
         0
    0.0002
    0.0003
    0.0003
    0.0011
    0.0026
    0.0028
    0.0023
    0.0012
    0.0001
    0.0001
    0.0012
    0.0015
    0.0013];
redsignal=redsignal./1.45;     %We divide the six spectra by different coefficients
orangesignal=orangesignal./1.4;
yellowsignal=yellowsignal./1.15;
greensignal=greensignal./1.3;
cyansignal=cyansignal./1.2;
bluesignal=bluesignal./1.1;
figure(3)
plot(lambda,bluesignal,'b');
hold on;
plot(lambda,cyansignal,'c');
hold on;
plot(lambda,greensignal,'g');
hold on;
plot(lambda,yellowsignal,'y');
hold on;
plot(lambda,orangesignal,'m');
hold on;
plot(lambda,redsignal,'r');
%% partII import the ZJU logo and generate a clorful target
load('ZJU.mat');
testimage=ZJU;
[testrows,testcols]=size(testimage);
figure(4)
imshow(testimage)
red=[0.98 0.08 0.13]; 
green=[0 0.62 0.08];
blue=[0 0.37 0.81];
yellow=[0.98 0.76 0]; 
black=[0 0 0];
white=[1 1 1];
orange=[0.93 0.38 0.11];
cyan=[0 0.75 0.93];
color1=red;
color2=orange;
color3=yellow;
color4=green;
color5=cyan;
color6=blue;
color7=black;
testimage1=zeros(testrows,testcols);
testimage2=zeros(testrows,testcols);
testimage3=zeros(testrows,testcols);
testimage4=zeros(testrows,testcols);
testimage5=zeros(testrows,testcols);
testimage6=zeros(testrows,testcols);
testRGB1=zeros(testrows,testcols,3);
testRGB2=zeros(testrows,testcols,3);
testRGB3=zeros(testrows,testcols,3);
testRGB4=zeros(testrows,testcols,3); 
testRGB5=zeros(testrows,testcols,3);
testRGB6=zeros(testrows,testcols,3);
testRGB=zeros(testrows,testcols,3);
%
for rowcounter=1:testrows
    for colcounter=1:testcols
        if testimage(rowcounter,colcounter)==0.5
            testimage1(rowcounter,colcounter)=1;
        else
            testimage1(rowcounter,colcounter)=0;
        end
    end
end
for rowcounter=1:testrows
    for colcounter=1:testcols
        if testimage(rowcounter,colcounter)==1
            testimage2(rowcounter,colcounter)=1;
        else
            testimage2(rowcounter,colcounter)=0;
        end
    end
end
for rowcounter=1:testrows
    for colcounter=1:testcols
        if testimage(rowcounter,colcounter)==0.3
            testimage3(rowcounter,colcounter)=1;
        else
            testimage3(rowcounter,colcounter)=0;
        end
    end
end
for rowcounter=1:testrows
    for colcounter=1:testcols
        if testimage(rowcounter,colcounter)==0.7
            testimage4(rowcounter,colcounter)=1;
        else
            testimage4(rowcounter,colcounter)=0;
        end
    end
end
for rowcounter=1:testrows
    for colcounter=1:testcols
        if testimage(rowcounter,colcounter)==0.9
            testimage5(rowcounter,colcounter)=1;
        else
            testimage5(rowcounter,colcounter)=0;
        end
    end
end
for rowcounter=1:testrows
    for colcounter=1:testcols
        if testimage(rowcounter,colcounter)==0.1
            testimage6(rowcounter,colcounter)=1;
        else
            testimage6(rowcounter,colcounter)=0;
        end
    end
end
%
redimage1=color1(1)*testimage1+color7(1)*~testimage1;
greenimage1=color1(2)*testimage1+color7(2)*~testimage1;
blueimage1=color1(3)*testimage1+color7(3)*~testimage1;
for rowcounter=1:testrows
    for colcounter=1:testcols
        testRGB1(rowcounter,colcounter,1)=redimage1(rowcounter,colcounter);
        testRGB1(rowcounter,colcounter,2)=greenimage1(rowcounter,colcounter);
        testRGB1(rowcounter,colcounter,3)=blueimage1(rowcounter,colcounter);
    end
end
redimage2=color2(1)*testimage2+color7(1)*~testimage2;
greenimage2=color2(2)*testimage2+color7(2)*~testimage2;
blueimage2=color2(3)*testimage2+color7(3)*~testimage2;
for rowcounter=1:testrows
    for colcounter=1:testcols
        testRGB2(rowcounter,colcounter,1)=redimage2(rowcounter,colcounter);
        testRGB2(rowcounter,colcounter,2)=greenimage2(rowcounter,colcounter);
        testRGB2(rowcounter,colcounter,3)=blueimage2(rowcounter,colcounter);
    end
end
redimage3=color3(1)*testimage3+color7(1)*~testimage3;
greenimage3=color3(2)*testimage3+color7(2)*~testimage3;
blueimage3=color3(3)*testimage3+color7(3)*~testimage3;
for rowcounter=1:testrows
    for colcounter=1:testcols
        testRGB3(rowcounter,colcounter,1)=redimage3(rowcounter,colcounter);
        testRGB3(rowcounter,colcounter,2)=greenimage3(rowcounter,colcounter);
        testRGB3(rowcounter,colcounter,3)=blueimage3(rowcounter,colcounter);
    end
end
redimage4=color4(1)*testimage4+color7(1)*~testimage4;
greenimage4=color4(2)*testimage4+color7(2)*~testimage4;
blueimage4=color4(3)*testimage4+color7(3)*~testimage4;
for rowcounter=1:testrows
    for colcounter=1:testcols
        testRGB4(rowcounter,colcounter,1)=redimage4(rowcounter,colcounter);
        testRGB4(rowcounter,colcounter,2)=greenimage4(rowcounter,colcounter);
        testRGB4(rowcounter,colcounter,3)=blueimage4(rowcounter,colcounter);
    end
end
redimage5=color5(1)*testimage5+color7(1)*~testimage5;
greenimage5=color5(2)*testimage5+color7(2)*~testimage5;
blueimage5=color5(3)*testimage5+color7(3)*~testimage5;
for rowcounter=1:testrows
    for colcounter=1:testcols
        testRGB5(rowcounter,colcounter,1)=redimage5(rowcounter,colcounter);
        testRGB5(rowcounter,colcounter,2)=greenimage5(rowcounter,colcounter);
        testRGB5(rowcounter,colcounter,3)=blueimage5(rowcounter,colcounter);
    end
end
redimage6=color6(1)*testimage6+color7(1)*~testimage6;
greenimage6=color6(2)*testimage6+color7(2)*~testimage6;
blueimage6=color6(3)*testimage6+color7(3)*~testimage6;
for rowcounter=1:testrows
    for colcounter=1:testcols
        testRGB6(rowcounter,colcounter,1)=redimage6(rowcounter,colcounter);
        testRGB6(rowcounter,colcounter,2)=greenimage6(rowcounter,colcounter);
        testRGB6(rowcounter,colcounter,3)=blueimage6(rowcounter,colcounter);
    end
end
testRGB=testRGB1+testRGB2+testRGB3+testRGB4+testRGB5+testRGB6;
figure(4)
imshow(testRGB)
%% partIII Generate spectral images from 350nm to 900nm
redpart=zeros(testrows,testcols,length(lambda));
orangepart=redpart;
yellowpart=redpart;
greenpart=redpart;
cyanpart=redpart;
bluepart=redpart;
flux=redpart;
for rowcounter=1:testrows
    creating_test_images_at_row=rowcounter
    for colcounter=1:testcols
        for wavelengthcounter=1:length(lambda)
           redpart(rowcounter,colcounter,wavelengthcounter)=testimage1(rowcounter,colcounter).*redsignal(wavelengthcounter);
           orangepart(rowcounter,colcounter,wavelengthcounter)=testimage2(rowcounter,colcounter).*orangesignal(wavelengthcounter);
           yellowpart(rowcounter,colcounter,wavelengthcounter)=testimage3(rowcounter,colcounter).*yellowsignal(wavelengthcounter);
           greenpart(rowcounter,colcounter,wavelengthcounter)=testimage4(rowcounter,colcounter).*greensignal(wavelengthcounter);
           cyanpart(rowcounter,colcounter,wavelengthcounter)=testimage5(rowcounter,colcounter).*cyansignal(wavelengthcounter);
           bluepart(rowcounter,colcounter,wavelengthcounter)=testimage6(rowcounter,colcounter).*bluesignal(wavelengthcounter);
           flux(rowcounter,colcounter,wavelengthcounter)=(redpart(rowcounter,colcounter,wavelengthcounter)+orangepart(rowcounter,colcounter,wavelengthcounter)+yellowpart(rowcounter,colcounter,wavelengthcounter)+greenpart(rowcounter,colcounter,wavelengthcounter)+...
              +cyanpart(rowcounter,colcounter,wavelengthcounter)+bluepart(rowcounter,colcounter,wavelengthcounter)); % modify according to the illumination   
        end
    end
end
figure(5)
for foo=51:5:351
imshow(flux(:,:,foo))
label= strcat(['Wavelength = ' num2str(lambda(foo)) 'nm'])
title(label)
pause(0.5)
end
% save 400-700nm spectral images (interval is 5nm)to mat
for i=1:61   
spectralimage(:,:,i)=flux(:,:,51+(i-1)*5);
end
save('spectralimage.mat','spectralimage')
